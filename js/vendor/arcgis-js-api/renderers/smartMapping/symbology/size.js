// COPYRIGHT Â© 2016 Esri
//
// All rights reserved under the copyright laws of the United States
// and applicable international laws, treaties, and conventions.
//
// This material is licensed for use under the Esri Master License
// Agreement (MLA), and is bound by the terms of that agreement.
// You may redistribute and use this code without modification,
// provided you adhere to the terms of the MLA and include this
// copyright notice.
//
// See use restrictions at http://www.esri.com/legal/pdfs/mla_e204_e300/english
//
// For additional information, contact:
// Environmental Systems Research Institute, Inc.
// Attn: Contracts and Legal Services Department
// 380 New York Street
// Redlands, California, USA 92373
// USA
//
// email: contracts@esri.com
//
// See http://js.arcgis.com/4.2/esri/copyright.txt for details.

define(["require","exports","dojo/_base/lang","../../../Color","./support/utils"],function(o,a,i,e,r){function t(){for(var o in w){var a=w[o],i=a.basemapGroups,e=D[o]={basemaps:[].concat(i.light).concat(i.dark),point:{},polyline:{},polygon:{}};for(var r in i)for(var t=i[r],n=0;n<t.length;n++){var l=t[n];a.pointSchemes&&(e.point[l]=a.pointSchemes[r]),a.lineSchemes&&(e.polyline[l]=a.lineSchemes[r]),a.polygonSchemes&&(e.polygon[l]=a.polygonSchemes[r])}}}function n(o,a){var i;if(o)switch(a){case"point":case"multipoint":var r=o;i={color:new e(r.color),noDataColor:new e(r.noDataColor),outline:{color:new e(r.outline.color),width:r.outline.width},size:r.size,noDataSize:r.noDataSize,minSize:r.minSize,maxSize:r.maxSize,opacity:r.opacity||1};break;case"polyline":var t=o;i={color:new e(t.color),noDataColor:new e(t.noDataColor),width:t.width,noDataWidth:t.noDataWidth,minWidth:t.minWidth,maxWidth:t.maxWidth,opacity:t.opacity||1};break;case"polygon":var n=o,l=n.marker,c=n.background;i={marker:{color:new e(l.color),noDataColor:new e(l.noDataColor),outline:{color:new e(l.outline.color),width:l.outline.width},size:l.size,noDataSize:l.noDataSize,minSize:l.minSize,maxSize:l.maxSize},background:{color:new e(c.color),outline:{color:new e(c.outline.color),width:c.outline.width}},opacity:o.opacity||1}}return i}function l(o){var a;return o&&(a=i.mixin({},o),a.color&&(a.color=new e(a.color)),a.noDataColor&&(a.noDataColor=new e(a.noDataColor)),a.outline&&(a.outline={color:a.outline.color&&new e(a.outline.color),width:a.outline.width})),a}function c(o,a){return o.size&&(o.size=r.toWorldScale(o.size,a)),o.noDataSize&&(o.noDataSize=r.toWorldScale(o.noDataSize,a)),o.minSize&&(o.minSize=r.toWorldScale(o.minSize,a)),o.maxSize&&(o.maxSize=r.toWorldScale(o.maxSize,a)),o}function p(o,a){return o.width&&(o.width=r.toWorldScale(o.width,a)),o.noDataWidth&&(o.noDataWidth=r.toWorldScale(o.noDataWidth,a)),o.minWidth&&(o.minWidth=r.toWorldScale(o.minWidth,a)),o.maxWidth&&(o.maxWidth=r.toWorldScale(o.maxWidth,a)),o}function d(o,a){return o.marker&&(o.marker=c(o.marker,a)),o}function m(o,a){var i="default",e=D[i],r=e&&e["multipoint"===a?"point":a];return r&&r[o]}var h=[128,128,128,1],s=[128,128,128,1],x={primary:{color:[227,139,79,1],noDataColor:h,outline:{color:[255,255,255,1],width:"1px"},noDataSize:"4px",size:"12px",minSize:"8px",maxSize:"50px",opacity:.8},secondary:[{color:[128,128,128,1],noDataColor:h,outline:{color:[255,255,255,1],width:"1px"},noDataSize:"4px",size:"12px",minSize:"8px",maxSize:"50px",opacity:.8},{color:[255,255,255,1],noDataColor:h,outline:{color:[128,128,128,1],width:"1px"},noDataSize:"4px",size:"12px",minSize:"8px",maxSize:"50px",opacity:.8}]},u={primary:{color:[227,139,79,1],noDataColor:s,outline:{color:[51,51,51,1],width:"1px"},noDataSize:"4px",size:"12px",minSize:"8px",maxSize:"50px",opacity:.8},secondary:[{color:[178,178,178,1],noDataColor:s,outline:{color:[51,51,51,1],width:"1px"},noDataSize:"4px",size:"12px",minSize:"8px",maxSize:"50px",opacity:.8},{color:[26,26,26,1],noDataColor:s,outline:{color:[128,128,128,1],width:"1px"},noDataSize:"4px",size:"12px",minSize:"8px",maxSize:"50px",opacity:.8}]},y={r:0,g:0,b:0,a:0},S={color:y,outline:{color:{r:166,g:166,b:166,a:1},width:"1px"}},z={color:y,outline:{color:{r:166,g:166,b:166,a:1},width:"1px"}},w={"default":{name:"default",label:"Default",description:"Default theme for visualizing features by varying their size to show data.",basemapGroups:{light:["streets","gray","topo","terrain","national-geographic","oceans","osm"],dark:["satellite","hybrid","dark-gray"]},pointSchemes:{light:x,dark:u},lineSchemes:{light:{primary:{color:[226,119,40,1],noDataColor:h,noDataWidth:"1px",width:"1px",minWidth:"1px",maxWidth:"18px"},secondary:[{color:[77,77,77,1],noDataColor:h,noDataWidth:"1px",width:"1px",minWidth:"1px",maxWidth:"18px"},{color:[153,153,153,1],noDataColor:h,noDataWidth:"1px",width:"1px",minWidth:"1px",maxWidth:"18px"}]},dark:{primary:{color:[226,119,40,1],noDataColor:s,noDataWidth:"1px",width:"1px",minWidth:"1px",maxWidth:"18px"},secondary:[{color:[255,255,255,1],noDataColor:s,noDataWidth:"1px",width:"1px",minWidth:"1px",maxWidth:"18px"},{color:[153,153,153,1],noDataColor:s,noDataWidth:"1px",width:"1px",minWidth:"1px",maxWidth:"18px"}]}},polygonSchemes:{light:{primary:{marker:x.primary,background:z,opacity:x.primary.opacity},secondary:[{marker:x.secondary[0],background:z,opacity:x.secondary[0].opacity},{marker:x.secondary[1],background:z,opacity:x.secondary[1].opacity}]},dark:{primary:{marker:u.primary,background:S,opacity:u.primary.opacity},secondary:[{marker:u.secondary[0],background:S,opacity:u.secondary[0].opacity},{marker:u.secondary[1],background:S,opacity:u.secondary[1].opacity}]}}}},D={};t();var W={getThemes:function(o){var a=[],i=r.normalizedBasemapId(o);for(var e in w){var t=w[e],n=D[e];i&&-1===n.basemaps.indexOf(i)||a.push({name:t.name,label:t.label,description:t.description,basemaps:n.basemaps.slice(0)})}return a},getSchemes:function(o){var a,i=o.geometryType,e=o.worldScale,t=o.view,l=m(r.normalizedBasemapId(o.basemap),i);if(l){var c=n(l.primary,i);a={primaryScheme:e?W.toWorldScale({scheme:c,view:t}):c,secondarySchemes:l.secondary.map(function(o){var a=n(o,i);return e?W.toWorldScale({scheme:a,view:t}):a})}}return a},cloneScheme:function(o){var a;return o&&(a=l(o),a.marker&&(a.marker=l(a.marker)),a.background&&(a.background=l(a.background))),a},toWorldScale:function(o){if(o.scheme&&o.view){var a=o.scheme,i=o.scheme,e=o.scheme,r=null;return a.hasOwnProperty("size")?r=c(a,o.view):i.hasOwnProperty("width")?r=p(i,o.view):e.hasOwnProperty("marker")&&(r=d(e,o.view)),r}}};return W});